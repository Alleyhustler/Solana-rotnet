"use strict";(()=>{const N=r("red"),k=r("blue"),E=r("fgcolor"),d=3,C=E,V=d,B=`12px ${r("monospace")}`,f=E,I=8,j=N,h=k,H=d,t=8,P=25,p=2,R=[2,5],g=k,v=d,b=25,m=1.5,A=.5,D=.5,e={t:25,l:360,b:325,r:660},O=0-A/m,z=1+D/m,n=p/2,T=m*1e3,F=new Set(["Tab","ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]),y=P**2,S=new RegExp(["^","cubic-bezier\\(","(?<x1>[+-]?[0-9.]+)",",","(?<y1>[+-]?[0-9.]+)",",","(?<x2>[+-]?[0-9.]+)",",","(?<y2>[+-]?[0-9.]+)",",?","\\)","$"].join("\\s*"),"u"),M=(e.r-e.l)/2+e.l,i=(e.b-e.t)/2+e.t,s=0,x=1,o=2;function r(e,t=document.documentElement){return getComputedStyle(t).getPropertyValue(`--${e}`)}function L(e){document.addEventListener("mouseout",t=>{const n=t.relatedTarget||t.toElement;(!n||n.nodeName==="HTML")&&e(t)})}function a(e){return e>-1&&e<0?"-"+String(e).slice(2):e>0&&e<1?String(e).slice(1):String(e)}function l(e,t){const n=10**t;return Math.round((e+1e-9)*n)/n}function u(e,t,n){return Math.min(Math.max(e,t),n)}function c(e,t,n){return(n-e)*t+e}function _(e,t){let n=e;if("changedTouches"in e)if(e.changedTouches.length>=1)n=e.changedTouches[0];else return{t:0,l:0};return{t:(n.pageY-t.offsetTop)*(t.height/t.offsetHeight),l:(n.pageX-t.offsetLeft)*(t.width/t.offsetWidth)}}class w extends HTMLElement{play=!1;#s={t:0,l:0,hover:!1,focus:s,click:!1};#i={t:0,l:0,hover:!1,focus:s,click:!1};#h=null;#a=O;#S=!1;#o;#r;#u;#e;#f;#p;#n;#y;#t;#b(){const t={l:a(l((this.#s.l-e.l)/(e.r-e.l),2)),t:a(l((e.b-this.#s.t)/(e.b-e.t),2)),r:a(l((this.#i.l-e.l)/(e.r-e.l),2)),b:a(l((e.b-this.#i.t)/(e.b-e.t),2))};this.#n.value=`cubic-bezier(${t.t}, ${t.l}, ${t.b}, ${t.r})`,this.#n.classList.remove("invalid")}#l(e){const t=this.#t.measureText(e);return{t:t.actualBoundingBoxAscent||10,l:t.actualBoundingBoxLeft||4,b:t.actualBoundingBoxDecent||10,r:t.actualBoundingBoxRight||4}}#d(n){n.t=u(e.t,n.t,e.b),n.l=u(t,n.l,this.#e.width-t)}#_(t,n,s,o){this.#s.t=c(e.b,t,e.t),this.#s.l=c(e.l,n,e.r),this.#i.t=c(e.b,s,e.t),this.#i.l=c(e.l,o,e.r),this.#d(this.#s),this.#d(this.#i)}#L(){const e=w.observedAttributes.map(e=>{const t=parseFloat(this.attributes[e].value);return isNaN(t)?e[1]==="2"?1:0:t});this.#_(...e),this.#b()}#T(){return this.#s.t<this.#i.t-t?[this.#s,this.#i]:this.#s.t<this.#i.t+t&&this.#s.l<this.#i.l?[this.#s,this.#i]:[this.#i,this.#s]}#E(t){const a=[-e.l+3*this.#s.l+-3*this.#i.l+e.r,3*e.l-6*this.#s.l+3*this.#i.l,-3*e.l+3*this.#s.l,e.l],s=[-e.b+3*this.#s.t+-3*this.#i.t+e.t,3*e.b-6*this.#s.t+3*this.#i.t,-3*e.b+3*this.#s.t,e.b-t],o=s[1]/s[0],u=s[2]/s[0],f=s[3]/s[0],d=o*o,m=d*o,c=(-d+3*u)/9,r=(-(2*m)+9*o*u-27*f)/54,l=c**3+r**2;let n;if(l>=0){const e=Math.sqrt(l);n=-o/3+Math.cbrt(r+e)+Math.cbrt(r-e)}else{const e=Math.acos(r/Math.sqrt(-(c**3))),t=Math.sqrt(-c)*2,s=2*Math.PI,i=o/3;for(let o=0;o<3&&(n=(o*s+e)/3,n=t*Math.cos(n)-i,!(n>=0&&n<=1));o++);}const i=n,h=i*i,p=h*i;return a[0]*p+a[1]*h+a[2]*i+a[3]}#x;#R;#c;#C(){this.#t.fillStyle=C,this.#t.strokeStyle=C,this.#t.lineWidth=V,this.#t.font=B,this.#t.beginPath(),this.#t.moveTo(e.l-5,e.t),this.#t.lineTo(e.l,e.t),this.#t.lineTo(e.l,e.b+10),this.#t.moveTo(e.l-10,e.b),this.#t.lineTo(e.r,e.b),this.#t.lineTo(e.r,e.b+5),this.#t.stroke(),this.#t.fillText("1",e.l-this.#R.r-10,e.t),this.#t.fillText("0",e.l-this.#x.r-10,e.b+this.#x.t+10),this.#t.fillText("1",e.r,e.b+this.#R.t+10),this.#t.fillText("T",e.l-this.#c-10,i-30),this.#t.fillText("i",e.l-this.#c-10,i-10),this.#t.fillText("m",e.l-this.#c-10,i+10),this.#t.fillText("e",e.l-this.#c-10,i+30),this.#t.fillText("Transition",M,e.b+this.#l("Transition").t+10)}#B(){this.#t.fillStyle=f,this.#t.strokeStyle=f,this.#t.lineWidth=I,this.#t.beginPath(),this.#t.moveTo(e.l,e.b),this.#t.bezierCurveTo(this.#s.l,this.#s.t,this.#i.l,this.#i.t,e.r,e.t),this.#t.stroke()}#A(e,s,i){this.#t.lineWidth=H,i.click?this.#t.strokeStyle=h:this.#t.strokeStyle=j,this.#t.beginPath(),this.#t.moveTo(e,s),this.#t.lineTo(i.l,i.t),this.#t.stroke(),i.hover|i.focus?this.#t.fillStyle=h:this.#t.fillStyle=j,this.#t.beginPath(),this.#t.arc(i.l,i.t,t,0,2*Math.PI),this.#t.fill(),i.focus===o&&(this.#t.strokeStyle=h,this.#t.setLineDash(R),this.#t.lineWidth=p,this.#t.beginPath(),this.#t.moveTo(i.l-t-n,i.t-t-n),this.#t.lineTo(i.l+t+n,i.t-t-n),this.#t.lineTo(i.l+t+n,i.t+t+n),this.#t.lineTo(i.l-t-n,i.t+t+n),this.#t.lineTo(i.l-t-n,i.t-t-n),this.#t.stroke(),this.#t.setLineDash([]))}#I(){this.#t.fillStyle=g,this.#t.strokeStyle=g,this.#t.lineWidth=v;const t=v/2,n=(1-u(1e-8,this.#a,.99999999))*(e.b-e.t)+e.t,s=this.#E(n);this.#t.beginPath(),this.#t.moveTo(s,t),this.#t.lineTo(s,this.#e.height-t),this.#t.moveTo(t,n),this.#t.lineTo(this.#e.width-t,n),this.#t.stroke(),this.#t.beginPath(),this.#t.arc(s,e.b+50+b,b,0,2*Math.PI),this.#t.fill()}#O(){this.#t.clearRect(0,0,this.#e.width,this.#e.height),this.#C(),this.#B(),this.#A(e.l,e.b,this.#s),this.#A(e.r,e.t,this.#i),this.#I()}#D=performance.now();#k(e){if(!this.#S)return;const t=(e-this.#D)/T;this.#D=e,this.play&&(this.#a=this.#a>z?O:this.#a+t),this.#O(),requestAnimationFrame(this.#k.bind(this))}#M(e){e.preventDefault()}#N(){const o=S.exec(this.#n.value),{x1:e,y1:n,x2:t,y2:s}=o?.groups??{};isNaN(e)||isNaN(t)||isNaN(n)||isNaN(s)||e<0||e>1||t<0||t>1?this.#n.classList.add("invalid"):(this.#_(e,n,t,s),this.#n.classList.remove("invalid"))}#F(){this.#u.tabIndex=-1,this.#f.tabIndex=-1,this.#h===null&&(this.#h=this.#T()[0]),this.#h.focus===s&&(this.#h.focus=o)}#P(){this.#h=this.#T()[0],this.#h.focus=o,this.#e.focus()}#U(){this.#h=this.#T()[1],this.#h.focus=o,this.#e.focus()}#K(){this.#u.tabIndex=0,this.#f.tabIndex=0,this.#s.focus=s,this.#i.focus=s}#z(t){if(F.has(t.key)){if(t.key==="Tab"){const e=this.#T();if(!t.shiftKey&&e[0].focus)e[0].focus=s,e[1].focus=o,this.#h=e[1];else if(t.shiftKey&&e[1].focus)e[0].focus=o,e[1].focus=s,this.#h=e[0];else return}else{const n=20/(t.shiftKey*4+1)*(t.ctrlKey*4+1);t.key==="ArrowUp"?this.#h.t-=(e.b-e.t)/n:t.key==="ArrowDown"?this.#h.t+=(e.b-e.t)/n:t.key==="ArrowLeft"?this.#h.l-=(e.r-e.l)/n:t.key==="ArrowRight"&&(this.#h.l+=(e.r-e.l)/n),this.#d(this.#h)}this.#b(),this.#O(),t.preventDefault()}}#g(e){let t;if(this.#s.click)t=this.#s;else if(this.#i.click)t=this.#i;else return;const n=_(e,this.#e);t.l=n.l,t.t=n.t,this.#d(t),this.#b(),this.#O(),e.preventDefault()}#m(e){const t=_(e,this.#e),n=(t.l-this.#s.l)**2+(t.t-this.#s.t)**2,s=(t.l-this.#i.l)**2+(t.t-this.#i.t)**2;n<=s&&n<=y?(this.#s.hover=!0,this.#i.hover=!1):s<=n&&s<=y?(this.#s.hover=!1,this.#i.hover=!0):(this.#s.hover=!1,this.#i.hover=!1)}#w(e){if(this.#e.focus(),"changedTouches"in e)this.#m(e);else if(e.button!=="undefined"&&e.button!==0)return;this.#s.hover?(this.#s.focus=x,this.#s.click=!0,this.#i.focus=s,this.#i.click=!1,this.#h=this.#s):this.#i.hover&&(this.#s.focus=s,this.#s.click=!1,this.#i.focus=x,this.#i.click=!0,this.#h=this.#i),this.#e.onmousemove=null,this.#o.onmousemove=this.#g.bind(this),this.#o.ontouchmove=this.#g.bind(this),this.#g(e)}#v(e){this.#s.click=!1,this.#i.click=!1,this.#o.onmousemove=null,this.#o.ontouchmove=null,this.#e.onmousemove=this.#m.bind(this),this.#m(e)}static observedAttributes=["x1","y1","x2","y2"];attributeChangedCallback(){this.#r&&this.#L()}connectedCallback(){this.#o=$("html"),!this.#r&&(this.#r=$(` <div tabindex=0></div> <canvas tabindex=0 height=450 width=1000 role="img" aria-label="Interactive b\xE9zier visualizer." ></canvas> <div tabindex=0></div> <form action="#"> <label for="cubic-func">B\xE9zier</label> <input dir="auto" id="cubic-func" type="text"></input> <button type="button" title="Reset">â†º</button> </form> `),[this.#u,this.#e,this.#f,this.#p]=this.#r,[,this.#n,this.#y]=this.#p.children,this.#t=this.#e.getContext("2d"),this.#x=this.#l("0"),this.#R=this.#l("1"),this.#c=Math.max(this.#l("T").r,this.#l("i").r,this.#l("m").r,this.#l("e").r),this.#o.onmouseup=this.#v.bind(this),this.#o.ontouchcancel=this.#v.bind(this),this.#o.ontouchend=this.#v.bind(this),this.#u.onfocus=this.#P.bind(this),this.#e.onblur=this.#K.bind(this),this.#e.onfocus=this.#F.bind(this),this.#e.onkeydown=this.#z.bind(this),this.#e.onmousedown=this.#w.bind(this),this.#e.onmousemove=this.#m.bind(this),this.#e.ontouchstart=this.#w.bind(this),this.#f.onfocus=this.#U.bind(this),this.#p.onsubmit=this.#M.bind(this),this.#n.onkeyup=this.#N.bind(this),this.#n.onblur=this.#b.bind(this),this.#y.onmouseup=this.#L.bind(this),L(this.#v.bind(this)),this.play=!!this.attributes.autoplay,this.#t.textBaseline="middle",this.#t.textAlign="center",this.#t.lineCap="round",this.#L(),this.replaceChildren(...this.#r),new IntersectionObserver(e=>{e[0].intersectionRatio>0?(this.#S=!0,requestAnimationFrame(this.#k.bind(this))):this.#S=!1}).observe(this))}}window.customElements.define("ve3zsh-bezier",w)})()